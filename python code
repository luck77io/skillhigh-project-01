import re
import math
import tkinter as tk
from tkinter import messagebox

# Function to calculate entropy of a password
def calculate_entropy(password):
    pool = 0
    if re.search(r"[a-z]", password):
        pool += 26
    if re.search(r"[A-Z]", password):
        pool += 26
    if re.search(r"[0-9]", password):
        pool += 10
    if re.search(r"[^a-zA-Z0-9]", password):
        pool += 32  # approx. number of common special characters

    if pool == 0:
        return 0
    entropy = len(password) * math.log2(pool)
    return round(entropy, 2)

# Function to check password strength
def check_strength():
    password = entry.get()
    strength = 0
    remarks = []

    # Length check
    if len(password) >= 8:
        strength += 1
    if len(password)>=12:
        strength +=1
       # Regex checks
    if re.search(r"[A-Z]", password):
        strength += 1
    else:
        remarks.append("Add at least one uppercase letter.")
        
    if re.search(r"[a-z]", password):
        strength += 1
    else:
        remarks.append("Add at least one lowercase letter.")
        
    if re.search(r"[0-9]", password):
        strength += 1
    else:
        remarks.append("Add at least one number.")
        
    if re.search(r"[^a-zA-Z0-9]", password):
        strength += 1
    else:
        remarks.append("Add at least one special character.")

    # Entropy calculation
    entropy = calculate_entropy(password)

    # Strength evaluation
    if strength <= 2:
        verdict = "Weak Password"
    elif strength <= 4:
        verdict = "Moderate Password"
    else:
        verdict = "Strong Password"

    result = f"Password Strength: {verdict}\nEntropy: {entropy} bits"
    if remarks:
        result += "\nSuggestions:\n- " + "\n- ".join(remarks)

    messagebox.showinfo("Password Check Result", result)

# Tkinter GUI
root = tk.Tk()
root.title("Password Strength Checker")
root.geometry("400x200")

label = tk.Label(root, text="Enter Password:", font=("Arial", 12))
label.pack(pady=10)

entry = tk.Entry(root, show="*", width=30, font=("Arial", 12))
entry.pack(pady=5)

check_btn = tk.Button(root, text="Check Strength", command=check_strength, font=("Arial", 12))
check_btn.pack(pady=10)

root.mainloop()
